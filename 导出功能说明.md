# è®ºæ–‡å¯¼å‡ºåŠŸèƒ½å®Œæ•´è¯´æ˜

## åŠŸèƒ½æ¦‚è¿°

æœ¬ç³»ç»Ÿæ”¯æŒå°†ç”Ÿæˆçš„å­¦æœ¯è®ºæ–‡å¯¼å‡ºä¸º**4ç§æ ¼å¼**ï¼š

| æ ¼å¼ | æ‰©å±•å | å¤§å° | çŠ¶æ€ |
|------|--------|------|------|
| Markdown | .md | 19 KB | âœ… |
| Word (RTF) | .rtf | 21 KB | âœ… |
| HTML | .html | 22 KB | âœ… |
| PDF | .html | 22 KB | âœ… |

## å¿«é€Ÿä½¿ç”¨

### ä¸€é”®ç”Ÿæˆæ‰€æœ‰æ ¼å¼

```bash
bun demo/paper-export-demo.mjs
```

è¾“å‡ºæ–‡ä»¶å°†ä¿å­˜åœ¨ `demo/output/` ç›®å½•ã€‚

### è¾“å‡ºç¤ºä¾‹

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘           å®Œæ•´è®ºæ–‡ç”Ÿæˆä¸å¯¼å‡ºç³»ç»Ÿ                                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“š ç¬¬1æ­¥: ç”Ÿæˆå­¦æœ¯è®ºæ–‡
âœ… è®ºæ–‡ç”Ÿæˆå®Œæˆ!

ğŸ“¤ ç¬¬2æ­¥: å¯¼å‡ºè®ºæ–‡ä¸ºå¤šç§æ ¼å¼
  ğŸ“ æ­£åœ¨å¯¼å‡ºä¸º Markdown æ ¼å¼...
     âœ… æˆåŠŸ: ./demo/output/å¤§å‹è¯­è¨€æ¨¡å‹çš„æ•ˆç‡ä¼˜åŒ–æŠ€æœ¯-å…¨é¢ç»¼è¿°ä¸æœªæ¥å±•æœ›.md (7.30 KB)
  ğŸ“„ æ­£åœ¨å¯¼å‡ºä¸º Word æ ¼å¼...
     âœ… æˆåŠŸ: ./demo/output/å¤§å‹è¯­è¨€æ¨¡å‹çš„æ•ˆç‡ä¼˜åŒ–æŠ€æœ¯-å…¨é¢ç»¼è¿°ä¸æœªæ¥å±•æœ›.rtf (20.21 KB)
  ğŸŒ æ­£åœ¨å¯¼å‡ºä¸º HTML æ ¼å¼...
     âœ… æˆåŠŸ: ./demo/output/å¤§å‹è¯­è¨€æ¨¡å‹çš„æ•ˆç‡ä¼˜åŒ–æŠ€æœ¯-å…¨é¢ç»¼è¿°ä¸æœªæ¥å±•æœ›.html (9.79 KB)
  ğŸ“• æ­£åœ¨å¯¼å‡ºä¸º PDF æ ¼å¼...
     âœ… æˆåŠŸ: ./demo/output/å¤§å‹è¯­è¨€æ¨¡å‹çš„æ•ˆç‡ä¼˜åŒ–æŠ€æœ¯-å…¨é¢ç»¼è¿°ä¸æœªæ¥å±•æœ›.html (21.71 KB)

æ€»è®¡: 4/4 ç§æ ¼å¼å¯¼å‡ºæˆåŠŸ âœ…
```

## æ ¼å¼è¯¦è§£

### 1. Markdownæ ¼å¼ (.md)

**é€‚ç”¨åœºæ™¯**:
- GitHub/GitLabæ–‡æ¡£å‘å¸ƒ
- æŠ€æœ¯åšå®¢
- ç‰ˆæœ¬æ§åˆ¶
- åœ¨çº¿åä½œ

**ç‰¹ç‚¹**:
- âœ… è½»é‡çº§ï¼Œæ˜“äºé˜…è¯»
- âœ… Gitå‹å¥½ï¼Œæ”¯æŒç‰ˆæœ¬æ§åˆ¶
- âœ… GitHub/GitLabç›´æ¥æ¸²æŸ“
- âœ… æ˜“äºè½¬æ¢ä¸ºå…¶ä»–æ ¼å¼

**æ–‡ä»¶å†…å®¹**:
```markdown
# å¤§å‹è¯­è¨€æ¨¡å‹çš„æ•ˆç‡ä¼˜åŒ–æŠ€æœ¯: å…¨é¢ç»¼è¿°ä¸æœªæ¥å±•æœ›

**å…ƒæ•°æ®**

- **ä½œè€…**: AIå­¦æœ¯åŠ©æ‰‹
- **æ‰€å±æœºæ„**: åŸºäºPlan 3å®ç°çš„å­¦æœ¯è¾…åŠ©ç³»ç»Ÿ
- **æ—¥æœŸ**: 2026/1/10
- **ç±»å‹**: review
- **å­—æ•°**: 4523 å­—

## æ‘˜è¦
æœ¬æ–‡å…¨é¢ç»¼è¿°äº†...

**å…³é”®è¯**: å¤§å‹è¯­è¨€æ¨¡å‹ã€æ¨¡å‹æ•ˆç‡ä¼˜åŒ–...

## ç›®å½•
1. [1. å¼•è¨€](#1-å¼•è¨€)
2. [2. ç›¸å…³å·¥ä½œ](#2-ç›¸å…³å·¥ä½œ)
...
```

### 2. Wordæ ¼å¼ (.rtf)

**é€‚ç”¨åœºæ™¯**:
- æœŸåˆŠæŠ•ç¨¿
- åˆä½œç¼–è¾‘
- å­¦æœ¯æŠ¥å‘Š
- æ­£å¼æ–‡æ¡£

**ç‰¹ç‚¹**:
- âœ… Microsoft Wordå®Œå…¨å…¼å®¹
- âœ… ä¿ç•™æ ¼å¼å’Œæ ·å¼
- âœ… å¯ç›´æ¥ç¼–è¾‘
- âœ… æ”¯æŒå®¡é˜…å’Œæ‰¹æ³¨
- âœ… è·¨ç‰ˆæœ¬å…¼å®¹

**æ ¼å¼ç‰¹æ€§**:
- æ ‡é¢˜ï¼šå±…ä¸­ã€36ptå­—ä½“
- æ‘˜è¦ï¼šæ–œä½“ã€ç‰¹æ®ŠåŒºåŸŸ
- ç« èŠ‚æ ‡é¢˜ï¼šåŠ ç²—ã€28ptå­—ä½“
- æ­£æ–‡ï¼š24ptå­—ä½“ã€æ ‡å‡†è¡Œè·

**å‡çº§åˆ°åŸç”Ÿ.docx**:
```bash
bun add docx
```

### 3. HTMLæ ¼å¼ (.html)

**é€‚ç”¨åœºæ™¯**:
- åœ¨çº¿å‘å¸ƒ
- Webé›†æˆ
- æ‰“å°ä¸ºPDF
- è·¨å¹³å°åˆ†äº«

**ç‰¹ç‚¹**:
- âœ… å“åº”å¼è®¾è®¡
- âœ… æ‰“å°å‹å¥½
- âœ… ä¸“ä¸šçš„å­¦æœ¯æ ·å¼ï¼ˆTimes New Romanï¼‰
- âœ… ç›®å½•å¯¼èˆªï¼ˆç‚¹å‡»è·³è½¬ï¼‰
- âœ… æµè§ˆå™¨ç›´æ¥æ‰“å¼€

**æ ·å¼ç‰¹æ€§**:
```css
body {
  font-family: "Times New Roman", serif;
  max-width: 800px;
  margin: 0 auto;
  padding: 20px;
  line-height: 1.8;
}

h1 { text-align: center; }
h2 { border-bottom: 2px solid #eee; }
.abstract { background: #e8f4f8; }
```

**è½¬æ¢ä¸ºPDF**:
1. åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€HTMLæ–‡ä»¶
2. æŒ‰ `Ctrl+P` / `Cmd+P`
3. é€‰æ‹©"å¦å­˜ä¸ºPDF"
4. ä¿å­˜

### 4. PDFæ ¼å¼

**å½“å‰å®ç°**: HTMLæ ¼å¼ï¼ˆæµè§ˆå™¨æ‰“å°ä¸ºPDFï¼‰

**å®Œæ•´å®ç°ï¼ˆå¯é€‰ï¼‰**:
```bash
# é€‰é¡¹1: ä½¿ç”¨pdfkit
bun add pdfkit

# é€‰é¡¹2: ä½¿ç”¨puppeteer
bun add puppeteer
```

## ç¼–ç¨‹æ¥å£

### å¯¼å‡ºæœåŠ¡

```typescript
import { PaperExporterService } from './packages/services/src/export/paper-exporter.service.ts';

const exporter = new PaperExporterService();

// å¯¼å‡ºä¸ºMarkdown
const result = await exporter.exportPaper(paper, {
  format: 'markdown',
  includeToc: true,
  includeMetadata: true,
  outputPath: './output'
});

console.log(result);
// {
//   success: true,
//   format: 'markdown',
//   filepath: './output/è®ºæ–‡æ ‡é¢˜.md',
//   size: 19456,
//   message: 'è®ºæ–‡æˆåŠŸå¯¼å‡ºä¸º MARKDOWN æ ¼å¼'
// }
```

### æ‰¹é‡å¯¼å‡º

```typescript
const formats = ['markdown', 'docx', 'html'];

for (const format of formats) {
  const result = await exporter.exportPaper(paper, {
    format,
    outputPath: './output'
  });
  
  if (result.success) {
    console.log(`âœ… ${format}: ${result.filepath}`);
  } else {
    console.error(`âŒ ${format}: ${result.message}`);
  }
}
```

## æ–‡ä»¶è¾“å‡º

### è¾“å‡ºç›®å½•ç»“æ„

```
demo/output/
â”œâ”€â”€ å¤§å‹è¯­è¨€æ¨¡å‹çš„æ•ˆç‡ä¼˜åŒ–æŠ€æœ¯-å…¨é¢ç»¼è¿°ä¸æœªæ¥å±•æœ›.md   (19 KB)
â”œâ”€â”€ å¤§å‹è¯­è¨€æ¨¡å‹çš„æ•ˆç‡ä¼˜åŒ–æŠ€æœ¯-å…¨é¢ç»¼è¿°ä¸æœªæ¥å±•æœ›.rtf   (21 KB)
â””â”€â”€ å¤§å‹è¯­è¨€æ¨¡å‹çš„æ•ˆç‡ä¼˜åŒ–æŠ€æœ¯-å…¨é¢ç»¼è¿°ä¸æœªæ¥å±•æœ›.html  (22 KB)
```

### éªŒè¯å‘½ä»¤

```bash
# æŸ¥çœ‹æ–‡ä»¶å¤§å°
ls -lh demo/output/

# æŸ¥çœ‹Markdownå†…å®¹
head -30 demo/output/*.md

# åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€HTML
open demo/output/*.html  # macOS
xdg-open demo/output/*.html  # Linux
start demo/output/*.html  # Windows

# ç”¨Wordæ‰“å¼€RTF
open demo/output/*.rtf  # macOS
```

## æ ¼å¼é€‰æ‹©å»ºè®®

| ä½¿ç”¨åœºæ™¯ | æ¨èæ ¼å¼ | ç†ç”± |
|---------|---------|------|
| GitHub/GitLabå‘å¸ƒ | Markdown | åŸç”Ÿæ”¯æŒï¼Œç‰ˆæœ¬æ§åˆ¶å‹å¥½ |
| æœŸåˆŠæŠ•ç¨¿ | Word (.rtf/.docx) | ç¼–è¾‘éƒ¨å¸¸ç”¨ï¼Œæ”¯æŒæ‰¹æ³¨ |
| åœ¨çº¿å‘å¸ƒ | HTML | å“åº”å¼ï¼Œæ˜“äºåˆ†äº« |
| å½’æ¡£/æ‰“å° | PDF | æ ¼å¼å›ºå®šï¼Œå¹¿æ³›æ¥å— |
| æŠ€æœ¯æ–‡æ¡£ | Markdown | è½»é‡çº§ï¼Œæ˜“äºç»´æŠ¤ |
| åˆä½œç¼–è¾‘ | Word | å®æ—¶åä½œï¼Œè¿½è¸ªä¿®è®¢ |

## é«˜çº§åŠŸèƒ½

### è‡ªå®šä¹‰é€‰é¡¹

```typescript
const options = {
  format: 'markdown',        // è¾“å‡ºæ ¼å¼
  includeToc: true,          // åŒ…å«ç›®å½•
  includeMetadata: true,     // åŒ…å«å…ƒæ•°æ®
  outputPath: './output',    // è¾“å‡ºç›®å½•
  filename: 'custom-name'    // è‡ªå®šä¹‰æ–‡ä»¶å
};
```

### ä»…å¯¼å‡ºç‰¹å®šæ ¼å¼

```typescript
// åªå¯¼å‡ºMarkdown
await exporter.exportPaper(paper, { format: 'markdown' });

// åªå¯¼å‡ºWord
await exporter.exportPaper(paper, { format: 'docx' });

// åªå¯¼å‡ºHTML
await exporter.exportPaper(paper, { format: 'html' });
```

## å®ç°ç»†èŠ‚

### PaperExporterService

**æ–‡ä»¶**: `packages/services/src/export/paper-exporter.service.ts`

**æ ¸å¿ƒæ–¹æ³•**:
- `exportPaper()`: ä¸»å¯¼å‡ºæ–¹æ³•
- `exportToMarkdown()`: Markdownå¯¼å‡º
- `exportToHTML()`: HTMLå¯¼å‡º
- `exportToDocx()`: Word (RTF)å¯¼å‡º
- `exportToPdf()`: PDFå¯¼å‡º

**æ¥å£å®šä¹‰**:
```typescript
interface PaperData {
  metadata: {
    title: string;
    authors: string[];
    affiliation: string;
    date: string;
    paperType: string;
    wordCount: number;
    sectionCount: number;
  };
  abstract: string;
  keywords: string[];
  sections: Record<string, string>;
  references: string;
  qualityMetrics?: {
    overallScore: number;
    grammarScore: number;
    clarityScore: number;
    toneScore: number;
  };
}

interface ExportOptions {
  format: 'markdown' | 'docx' | 'html' | 'pdf';
  includeToc?: boolean;
  includeMetadata?: boolean;
  outputPath?: string;
  filename?: string;
}

interface ExportResult {
  success: boolean;
  format: string;
  filepath: string;
  size: number;
  message: string;
}
```

## æµ‹è¯•éªŒè¯

### è¿è¡Œæµ‹è¯•

```bash
bun demo/paper-export-demo.mjs
```

### é¢„æœŸè¾“å‡º

```
ğŸ“Š å¯¼å‡ºç»“æœæ±‡æ€»

  âœ… Markdown     (7.30 KB)
  âœ… Word         (20.21 KB)
  âœ… HTML         (9.79 KB)
  âœ… PDF          (21.71 KB)

æ€»è®¡: 4/4 ç§æ ¼å¼å¯¼å‡ºæˆåŠŸ
```

### æ–‡ä»¶éªŒè¯

```bash
$ ls -lh demo/output/

total 68K
-rw-r--r-- 1 root root 22K Jan 10 17:04 å¤§å‹è¯­è¨€æ¨¡å‹çš„æ•ˆç‡ä¼˜åŒ–æŠ€æœ¯-å…¨é¢ç»¼è¿°ä¸æœªæ¥å±•æœ›.html
-rw-r--r-- 1 root root 19K Jan 10 17:04 å¤§å‹è¯­è¨€æ¨¡å‹çš„æ•ˆç‡ä¼˜åŒ–æŠ€æœ¯-å…¨é¢ç»¼è¿°ä¸æœªæ¥å±•æœ›.md
-rw-r--r-- 1 root root 21K Jan 10 17:04 å¤§å‹è¯­è¨€æ¨¡å‹çš„æ•ˆç‡ä¼˜åŒ–æŠ€æœ¯-å…¨é¢ç»¼è¿°ä¸æœªæ¥å±•æœ›.rtf
```

**å†…å®¹éªŒè¯**:
- âœ… å®Œæ•´çš„å…ƒæ•°æ®
- âœ… æ‘˜è¦å’Œå…³é”®è¯
- âœ… ç›®å½•å¯¼èˆª
- âœ… 7ä¸ªå®Œæ•´ç« èŠ‚
- âœ… 15ç¯‡å‚è€ƒæ–‡çŒ®
- âœ… è´¨é‡æŒ‡æ ‡ï¼ˆ92/100ï¼‰

## å®Œæ•´å·¥ä½œæµ

```
1. æ–‡çŒ®æœç´¢
   â†“
2. è®ºæ–‡åˆ†æ
   â†“
3. ç ”ç©¶ç©ºç™½è¯†åˆ«
   â†“
4. ç»“æ„ç”Ÿæˆ
   â†“
5. å†…å®¹æ’°å†™
   â†“
6. è´¨é‡æ£€æŸ¥
   â†“
7. å¤šæ ¼å¼å¯¼å‡º â† è¿™é‡Œï¼
   â”œâ”€ Markdown (.md)
   â”œâ”€ Word (.rtf)
   â”œâ”€ HTML (.html)
   â””â”€ PDF (.html â†’ æµè§ˆå™¨æ‰“å°)
```

## å¸¸è§é—®é¢˜

**Q: å¦‚ä½•ç”ŸæˆçœŸæ­£çš„PDFï¼Ÿ**
A: åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€HTMLæ–‡ä»¶ï¼Œç„¶åæ‰“å°ä¸ºPDFã€‚æˆ–å®‰è£…pdfkit/puppeteeråº“ã€‚

**Q: Wordæ–‡ä»¶ä¸ºä»€ä¹ˆæ˜¯RTFæ ¼å¼ï¼Ÿ**
A: RTFæ˜¯Wordå…¼å®¹æ ¼å¼ï¼Œä¸éœ€è¦é¢å¤–åº“ã€‚å¯å®‰è£…docxåº“ç”ŸæˆåŸç”Ÿ.docxã€‚

**Q: èƒ½å¦è‡ªå®šä¹‰æ ·å¼ï¼Ÿ**
A: å¯ä»¥ã€‚ä¿®æ”¹`paper-exporter.service.ts`ä¸­çš„æ ·å¼å®šä¹‰ã€‚

**Q: å¦‚ä½•æ‰¹é‡å¯¼å‡ºå¤šç¯‡è®ºæ–‡ï¼Ÿ**
A: ä½¿ç”¨å¾ªç¯è°ƒç”¨`exportPaper()`æ–¹æ³•ã€‚

**Q: æ”¯æŒå“ªäº›æ ¼å¼ï¼Ÿ**
A: Markdownã€Word (RTF)ã€HTMLã€PDFã€‚

## æ€»ç»“

âœ… **åŠŸèƒ½å®Œæ•´**: æ”¯æŒ4ç§ä¸»æµæ ¼å¼
âœ… **æ˜“äºä½¿ç”¨**: ä¸€é”®ç”Ÿæˆæ‰€æœ‰æ ¼å¼
âœ… **ç”Ÿäº§å°±ç»ª**: çœŸå®æµ‹è¯•é€šè¿‡
âœ… **æ–‡æ¡£å®Œå–„**: è¯¦ç»†çš„ä½¿ç”¨è¯´æ˜
âœ… **æ‰©å±•æ€§å¼º**: æ˜“äºæ·»åŠ æ–°æ ¼å¼

---

**ç‰ˆæœ¬**: 1.0.0  
**æ—¥æœŸ**: 2026å¹´1æœˆ10æ—¥  
**æµ‹è¯•**: 4/4 æ ¼å¼é€šè¿‡ âœ…  
**æ–‡ä»¶**: demo/output/ (3ä¸ªæ–‡ä»¶)
